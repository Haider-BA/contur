      SUBROUTINE AXIAL
C
C     TO OBTAIN THE AXIAL DISTRIBUTIUN OF VELOCITY AND/OR MACH NUMBER
C
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON /FG/ GC,GD,GE,GF,GH,GI,HA,HB,HC,HE
      COMMON /GG/ GAM,GM,G1,G2,G3,G4,G5,G6,G7,G8,G9,GA,RGA,QT
      COMMON /CLINE/ AXIS(5,150),TAXI(5,150),WIP,X1,FRIP,ZONK,SEO,CSE
      COMMON /PROP/ AR,ZO,RO,VISC,VISM,SFOA,XBL,CONV
      COMMON /PARAM/ ETAD,RC,AMACH,BMACH,CMACH,EMACH,GMACH,FRC,SF,WWO,WW
     1OP,QM,WE,CBET,XE,ETA,EPSI,BPSI,XO,YO,RRC,SDO,XB,XC,AH,PP,SE,TYE,XA
      COMMON /CONTR/ ITLE(3),IE,LR,IT,JB,JQ,JX,KAT,KBL,KING,KO,LV,NOCON,
     1IN,MC,MCP,IP,IQ,ISE,JC,M,MP,MQ,N,NP,NF,NUT,NR,LC,MD,MF,MT,ND,NT
      DATA ZRO/0.0D+0/,ONE/1.D+0/,TWO/2.D+0/,SIX/6.D+0/,HALF/5.D-1/
      DATA THR/3.D+0/,FOUR/4.D+0/,FIV/5.D+0/,TEN/1.D+1/,TLV/1.2D+1/
      DATA SEV/7.D+0/,EIT/8.D+0/,FFTN/1.5D+1/,TRTY/3.D+1/,SXTY/6.D+1/
      DATA N1/4HGMAC/,M2/4H2-D /,TAXIS/4HAXIS/,NS/4H SPE/,NC/4HCIAL/
      DATA N3/4H 3RD/,N4/4H 4TH/,N5/4H 5TH/,N0/4H-DEG/
      DIMENSION C(6), D(4), AX(150), AXM(150), AXMP(150)
C
      NPI=9.D+1/CONV
      IF (JQ.EQ.0.AND.JX.EQ.0) CALL OREZ(AXIS,2*750)
      IF (JQ .GT. 0) GO TO 50
      IF (JX .EQ. 0) GO TO 2
C
C     CARD USED TO OBTAIN INTERNAL STREAMLINES (JX > 0)
C
      READ (1,93,END=91) ETAD,QM,XJ
C
      JX=XJ
      IF (ETAD .EQ. SXTY) GO TO 1
      ETA=ETAD/CONV
      IF (IE .EQ. 0) SE=ETA
      IF (IE .EQ. 1) SE=TWO*DSIN(HALF*ETA)
      CSE=DCOS(ETA)
      APSI=BPSI-ETA/QT
      AMACH=FMV(APSI)
      RA=((G6+G5*AMACH**2)**GA/AMACH)**QT
      GPSI=EPSI+ETA/QT
      GMACH=FMV(GPSI)
      RG=((G6+G5*GMACH**2)**GA/GMACH)**QT
      MP=ONE+THR*(RA-RG)
      GO TO 14
1     SE=QM*SEO
      GO TO 14
C
C     CONSTANTS USED IN TRANSONIC SOLUTION
2     GC=(TWO*GAM/QT-THR)/SIX/(3+IE)
      GE=(THR*(8+IE)-FOUR*GAM/QT)/THR/(7+IE)
      GH=(FFTN+(2-6*IE)*GAM)/TLV/(5+IE)
      GJ=(GAM*(GAM+9.25D+0*IE-26.5D+0)+.75D+0*(6-IE))/TLV/(3-IE)
      GK=(GAM*(GAM+2.25D+0*IE-16.5D+0)+2.25D+0*(2+IE))/SIX
      GR=(FFTN-(1+9*IE)*GAM)/(15+IE)/18.D+0
      HB=(14.D+0*GAM-75.D+0+18*IE)/(270.D+0+18*IE)
      IF (IE .EQ. 0) GO TO 3
      GD=(GM*(652.D+0*GM+1319.D+0)+1000.D+0)/6912.D+0
      GF=(3612.D+0+GM*(751.D+0+GM*754.D+0))/2880.D+0
      GI=(909.D+0+GAM*(270.D+0+GAM*412.D+0))/10368.D+0
      GS=(GAM*(GAM*2708.D+0+2079.D+0)+2115.D+0)/82944.D+0
      HC=(GAM*(2364.D+0*GAM-3915.D+0)+14337.D+0)/82944.D+0
      HE=(GAM*(64.D+0*GAM+117.D+0)-1026.D+0)/1152.D+0
      GO TO 4
C
C     AXISYM FLOW, IE=1, QT=0.5, GAM=1.4, GC=0.10833333, GD=0.236099537,
C     GE=0.65833333, GF=1.40036111, GH=0.13055556, GI=0.2020177469,
C     GJ=0.76833333, GK=-1.87333333, GR=0.003472222, GS=0.1245814043,
C     HB=0.12986111, HC=0.1626331019, HE=-0.6395486111
C
3     GD=(GM*(32.D+0*GM-14.D+0)+221.D+0)/1080.D+0
      GF=(4230.D+0+GM*(211.D+0+GM*334.D+0))/3780.D+0
      GI=(738.D+0+GAM*(273.D+0-GAM*82.D+0))/7560.D+0
      GS=(GAM*(GAM*782.D+0+3507.D+0)+7767.D+0)/272160.D+0
      HC=(GAM*(274.D+0*GAM-861.D+0)+4464.D+0)/17010.D+0
      HE=(GAM*(32.D+0*GAM+87.D+0)-561.D+0)/540.D+0
C
C     PLANAR FLOW, IE=0, QT=1.0,GAM=1.4, GC=-0.011111, GD=0.2041851852,
C     GE=0.8761904762, GF=1.155513228, GH=0.29666667, GI=0.1269153439,
C     GJ=-0.85111111, GK=-2.7733333, GR=0.05037037037, GS=0.05221017049,
C     HB=-0.2051851852, HC=0.2231416814, HE=-0.6971851852
C
C     CARD USED TO ESTABLISH INVISCID PARAMETERS
C
4     READ (1,93,END=91) ETAD,RC,FMACH,BMACH,CMC,SF,PP,XC
C
C     CARD USED TO CONTROL CALCULATIONS
C
      READ (1,92) MT,NT,IX,IN,IQ,MD,ND,NF,MP,MQ,JB,JX,JC,IT,LR,NX
C
      LC=XC
      IF (XC .GT. ONE) LC=XC+ONE
      NR=SIX*RC
      MF=FMACH
      IF (IE .EQ. 1) MC=M1
      IF (IE .EQ. 0) MC=M2
      NOCON=0
      ETA=ETAD/CONV
      IF (IE .EQ. 0) SE=ETA
      IF (IE .EQ. 1) SE=TWO*DSIN(HALF*ETA)
      IF (ETAD .EQ. SXTY) SE=ONE
      SEO=SE
      ISE=SE
      CSE=DCOS(ETA)
      RT=RC+ONE
      AM=ONE
      WI=ONE
      WIPP=ZRO
      MCP=CMC
      CMACH=DABS(CMC)
      CBET=DSQRT(CMACH*CMACH-ONE)
      FRC=((G6+G5*CMACH**2)**GA/CMACH)**QT
      TYE=FRC*SE
      IF (SF .LT. ZRO) SF=-SF/TYE
      IF (ISE .EQ. 0) GO TO 5
C
C     NON-RADIAL FLOW AT INFLECTION POINT
      IQ=1
      AMACH=CMACH
      BMACH=CMACH
      EMACH=CMACH
      FMACH=CMACH
      GMACH=CMACH
      IF (IE .EQ. 1) AM=GMACH
      WE=G2*EMACH/DSQRT(EMACH**2+G9)
      DW=WE-WI
      XO=ZRO
      EOE=ZRO
      GO TO 15
C
C     RADIAL FLOW AT INFLECTION POINT
5     IF (IN .EQ. 0) GO TO 6
      IF ((LC .LT. 0) .AND. (IN .LT. 0)) IN=-1
      IF ((LC .EQ. 0) .OR. (MCP .LT. 0)) IN=ISIGN(10,IN)
6     BBET=DSQRT(BMACH*BMACH-ONE)
      BPSI=G2*DATAN(G4*BBET)-DATAN(BBET)
      IF (FMACH) 9,8,7
7     FBET=DSQRT(FMACH*FMACH-ONE)
      FPSI=G2*DATAN(G4*FBET)-DATAN(FBET)
      GO TO 10
8     FMACH=-BPSI/ETA
      IF (BPSI/ETA .GT. 7.5D+0) FMACH=-7.5D+0
9     FPSI=-FMACH*ETA
      FMACH=FMV(FPSI)
10    EPSI=FPSI-TWO*ETA/QT
      EMACH=FMV(EPSI)
      WE=G2*EMACH/DSQRT(EMACH*EMACH+G9)
      DW=WE-WI
      CALL SORCE(WE,D)
      XE=D(1)
      WEP=D(2)
      WEPP=D(3)
      WRPPP=D(4)
      IF (NR .NE. 0) GO TO 15
      IF ((LR .NE. 0) .OR. (IQ .LT. 0)) GO TO 11
      IF (IX .EQ. 0) WRITE (6,106) ITLE,N3
      IF (IX .NE. 0) WRITE (6,106) ITLE,N4
C
C     ITERATION TO DETERMINE RC IF NOT SPECIFIED (NR = 0)
11    EA=WRPPP
      EB=-FIV*WEPP-WIPP
      EC=TLV*WEP
      ED=-TLV*DW
      XIE=CUBIC(EA,EB,EC,ED)
      IF (XIE .LE. ZRO) GO TO 89
12    WIP=TWO*(WE-ONE)/XIE-WEP+(WEPP-WIPP)*XIE/SIX
13    NOCON=NOCON+1
      IF (NOCON .GT. 100) GO TO 90
14    RT=TORIC(WIP,SE)
      RC=RT-ONE
15    TK=(ONE-G7*(ONE+(GE+GF/RT)/RT)/RT**2/(15+IE)/THR)**QT
      YO=SE/TK
      AA=DSQRT(QT*(GAM+ONE)*RT)
      IF (QM .NE. ONE) GO TO 19
      WHPP=(ONE-GAM/1.5D+0+GJ/RT)/(AA*YO)**2
      IF ((NR .NE. 0) .OR. (ISE.EQ. 1)) GO TO 18
      IF (DABS(WHPP-WIPP) .LT. 1.D-10) GO TO 18
      WIPP=WHPP
      IF (IX) 11,17,16
16    EA=GK/(AA*YO)**3
      EB=THR*(WIPP+WEPP)
      EC=-TLV*WEP
      ED=TLV*DW
      XIE=CUBIC(EA,EB,EC,ED)
      IF (XIE .LE. ZRO) GO TO 89
      GO TO 12
17    H=(EIT*WIP+SEV*WEP)/(THR*WIPP-TWO*WEPP)
      HH=TRTY*DW/(THR*WIPP-TWO*WEPP)
      XIE=HH/(DSQRT(H*H+HH)+H)
      WIP=WEP-HALF*XIE*(WEPP+WIPP)
      GO TO 13
C
C     ITERATION FOR RC COMPLETED, REMAINDER OF TRANSONIC VALUES COMPUTED
18    WIP=(ONE-(GC-GD/RT)/RT)/YO/AA
      WHP=WIP
      WIPP=WHPP
      AMP=G7*WIP
      AMPP=G7*(WHPP+THR*G8*WIP**2)
19    XOI=YO*DSQRT(G7/TWO/(9-IE)/RT)*(ONE+(GH+GI/RT)/RT)
      IF (QM .NE. ONE) GO TO 21
      IF (ISE .EQ. 1) XI=XOI
      XO1=XOI
      WO=ONE-(HALF/(3-IE)+(GR+GS/RT)/RT)/RT
      OM=WO/DSQRT(G7-G8*WO**2)
      WOPPP=GK/(AA*YO)**3
      IF (LR .EQ. 0) GO TO 21
C
C     CALL FOR THROAT CHARACTERISTIC VALUES
      CALL TRANS (RT,TK,WO,AM,AMP,AMPP,WI,AWP,AWPP,AWPPP,XI)
      IF ((NX .LT. 0) .AND. (NT.LT.0)) GO TO 87
      IF (NX .LT. 0) GO TO 4
      AMP=AMP/SE
      AMPP=AMPP/SE**2
      WAP=AWP/SE
      WAPP=AWPP/SE**2
      WOPPP=AWPPP/SE**3
      IF (ISE .EQ. 1) GO TO 21
      DW=WE-WI
      XOI=XI*SE
      IF (NR .GT. 0) GO TO 20
      X1=XE-XIE
      XO=XE-XIE-XO1
      C2=XIE*WIP
      C3=HALF*WIPP*XIE**2
      C4=WE-ONE-C2-C3
      IF (IX .NE. 0) C4=FOUR*C4+TWO*C3+C2-XIE*WEP
      IF (IQ .LT. 0) GO TO 20
      WRITE (6,110) ITLE,N4,LR
      WRITE (6,96) XIE,C2,C3,C4,X1
20    WIP=WAP
      WIPP=WAPP
21    WWO=ONE+(ONE/(IE+3)-(HB-HC/RT)/RT)/RT
      WWOP=(ONE+(ONE-IE/EIT-HE/RT)/RT)/YO/AA
      RRC=ONE/RC
      SDO=RRC/YO
      ZONK=QM+1.0D-03
      NP=ZONK*(IABS(NF)-1)+1
      IF (SF .GT. ZRO)  GO TO 22
      SF=ONE/YO
22    IF (IQ  .LT. 0)  GO TO 31
      IP=0
      JQ=0
      M=ZONK*(MT-1)+1
      N=NT
      IF  (QM  .EQ. ONE)  GO TO 23
      XO=X1-XOI
      RETURN
23    CALL  OREZ (C,6)
      IF  (ISE .EQ. 0)  GO TO 31
C
C     LENGTH OF AXIAL DISTRIBUTION FOR NON-RADIAL FLOW
      X1=XOI
      AEM=EMACH-AM
      C(1)=AM
      IF (LC) 25,24,27
24    AMSQ=AMP**2+AEM*AMPP*FOUR/THR
      IF (LR .EQ. 0) WRITE (6,122) ITLE,N4,N0
      IF (LR .NE. 0) WRITE (6,107) ITLE,N4,N0,LR
      IF (AMSQ .LT. ZRO) GO TO 28
      XIE=FOUR*AEM/(DSQRT(AMSQ)+AMP)
      XE=XIE+XI
      C(5)=THR*AEM-AMP*XIE
      GO TO 26
25    XIE=THR*AEM/AMP
      XE=XIE+XI
      IF (LR .EQ. 0) WRITE (6,122) ITLE,N3,N0
      IF (LR .NE. 0) WRITE (6,107) ITLE,N3,N0,LR
26    C(2)=AMP*XIE
      C(3)=SIX*AEM-THR*C(2)
      C(4)=THR*C(2)-EIT*AEM
      GO TO 46
27    IF (LC .EQ. 1) GO TO 29
      XE=XC/TK
      XIE=FIV*AEM/(DSQRT(AMP**2+IN*AEM*AMPP/EIT)+AMP)
      IF (XE .GT. XI+XIE) XE=XI+XIE
      XIE=XE-XI
      C(2)=AMP*XIE
      C(3)=HALF*IN*AMPP*XIE**2/TEN
      C(4)=TEN*AEM-SIX*C(2)-THR*C(3)
      C(5)=-FFTN*AEM+EIT*C(2)+THR*C(3)
      C(6)=SIX*AEM-THR*C(2)-C(3)
      IF (LR .EQ. 0) WRITE (6,122) ITLE,N5,N0
      IF (LR .NE. 0) WRITE (6,107) ITLE,N5,N0,LR
      GO TO 46
28    C(2)=TWO*AEM
      C(4)=-C(2)
      C(5)=AEM
      XIE=TWO*AEM/AMP
      XE=XIE+XI
      GO TO 46
29    DO 30 J=1,NT
      K=NT+1-J
      READ(9) AX(K),AXM(K),AXMP(K)
      IF (J .EQ. 1) DX=XI-AX(K)
30    AXIS(1,K)=AX(K)+DX
      AXM(NT)=AM
      AXMP(NT)=AMP
      XE=AXIS(1,1)
      XIE=XE-XI
      IF (LR .EQ. 0) WRITE (6,122) ITLE,N5,N0
      IF (LR .NE. 0) WRITE (6,107) ITLE,N5,N0,LR
      GO TO 46
C
C     LENGTH OF UPSTREAM AXIAL DISTRIBUTION FOR RADIAL FLOW
31    IF (SFOA .EQ. ZRO) GO TO 32
      IF (LR .EQ. 0) WRITE (6,106) ITLE,N5
      IF (LR .NE. 0) WRITE (6,110) ITLE,N5,LR
      GO TO 44
32    IF (LR .EQ. 0) GO TO 33
      IF ((NR .EQ. 0) .AND. (IX .EQ. 0)) GO TO 41
      IF ((NR .EQ. 0) .AND. (IX .NE. 0)) MF=0
      IF (MF .NE. 0) GO TO 40
      IF ((IQ .LT. 0) .OR. (NR .EQ. 0)) GO TO 35
      IF (IX .EQ. 0) WRITE (6,110) ITLE,N3,LR
      IF (IX .NE. 0) WRITE (6,110) ITLE,N4,LR
      GO TO 35
33    IF (MF .EQ. 0) GO TO 34
      IF (NR .EQ. 0) GO TO 45
      IF (IQ .GE. 0) WRITE (6,106) ITLE,N4
      GO TO 41
C
C     ITERATION FOR EMACH IF NOT SPECIFIED (MF = 0)
34    IF (IQ .LT. 0) GO TO 35
      IF (IX .EQ. 0) WRITE (6,106) ITLE,N3
      IF (IX .NE. 0) WRITE (6,106) ITLE,N4
35    IF (NOCON .GT. 100) GO TO 90
      IF (IX) 41,36,37
36    XIE=SIX*DW/(DSQRT((WIP+WEP+WEP)**2-SIX*DW*WEPP)+WIP+WEP+WEP)
      FXW=HALF*XIE*(WEPP+WIPP)/(WEP-WIP)
      IF (FXW .LE. ZRO) EW=WE+.1D+0
      IF (FXW .LE. ZRO) GO TO 39
      IF (FXW .LT. ONE) EW=WI+DW*(FOUR+FXW**2)/FIV
      IF ((FXW .GT. ONE) .OR. (IE .EQ. 0)) EW=WI+DW*(9.D+0+FXW)/TEN
      GO TO 39
37    EA=WOPPP
      EB=FIV*WIPP+WEPP
      EC=TLV*WIP
      ED=-TLV*DW
      XIE=CUBIC(EA,EB,EC,ED)
      IF (XIE .GT. ZRO) GO TO 38
      EW=WE-.1D+0
      IF (EW .GT. WI) GO TO 39
      WRITE (6,113)
      GO TO 4
38    EW=WI+HALF*XIE*(WIP+WEP+XIE*(WIPP-WEPP)/SIX)
39    WE=EW
C      IF (WE .GT. G2) GO TO 79
      IF (WE .GT. G2) STOP
      IF (DABS(EW-DW-WI) .LT. 1.D-9) GO TO 43
      DW=WE-WI
      CALL SORCE(WE,D)
      XE=D(1)
      WEP=D(2)
      WEPP=D(3)
      WRPPP=D(4)
      NOCON=NOCON+1
      GO TO 35
40    IF (IQ .LT. 0) GO TO 41
      WRITE (6,110) ITLE,N4,LR
41    H=THR*(WEP+WIP)/(WIPP-WEPP)
      HH=TLV*DW/(WIPP-WEPP)
      XIE=HH/(DSQRT(H*H+HH)+H)
      IF (MF) 44,42,45
42    EW=WI+XIE*(WIP+THR*WEP-XIE*(WEPP-XIE*WRPPP/SIX))/FOUR
      GO TO 39
43    EMACH=WE/DSQRT(G7-G8*WE*WE)
C
C     ITERATION FOR EMACH COMPLETED
      EBET=DSQRT(EMACH*EMACH-ONE)
      EPSI=G2*DATAN(G4*EBET)-DATAN(EBET)
      FPSI=EPSI+TWO*ETA/QT
      FMACH=FMV(FPSI)
44    IF (BMACH .GT. FMACH) GO TO 45
      BMACH=FMACH
      BPSI=FPSI
      MP=0
45    GPSI=FPSI-ETA/QT
      GMACH=FMV(GPSI)
      IF (IE .EQ. 1) AH=GMACH
      RG=((G6+G5*GMACH**2)**GA/GMACH)**QT
      APSI=BPSI-ETA/QT
      AMACH=FMV(APSI)
      RA=((G6+G5*AMACH**2)**GA/AMACH)**QT
      XA=RA*CSE
      IF (SFOA .GT. ZRO) XIE=SFOA/SF+XE-XA-XOI
      IF (SFOA .LT. ZRO) XIE=XE-SFOA/SF-RG*CSE-XOI
      XI=XE-XIE
      XO=XI-XOI
      X1=XO+XO1
      IF (IQ .LT. 0) GO TO 48
      XB=((G6+G5*BMACH**2)**GA/BMACH)**QT
      IF (LC .LT. 2) XC=((G6+G5*CMACH**2)**GA/CMACH)**QT
      C(1)=WI
      C(2)=XIE*WIP
      C(3)=HALF*WIPP*XIE*XIE
      C(4)=TEN*DW-XIE*(FOUR*WEP-HALF*XIE*WEPP)-SIX*C(2)-THR*C(3)
      C(5)=XIE*(SEV*WEP+EIT*WIP-XIE*(WEPP-THR*WIPP/TWO))-FFTN*DW
      C(6)=SIX*DW-THR*XIE*(WEP+WIP)+HALF*XIE*XIE*(WEPP-WIPP)
      IF (MF .EQ. 0 .AND. IX .EQ. 0) C(5)=ZRO
      IF (NR .EQ. 0 .AND. IX .EQ. 0 .AND. LR .EQ. 0) C(5)=ZRO
      IF (SFOA .EQ. ZRO) C(6)=ZRO
      EOE=EPSI/ETA
      WIPPP=SIX*C(4)/XIE/XIE/XIE
      WEPPP=SIX*(C(4)+FOUR*C(5)+TEN*C(6))/XIE/XIE/XIE
46    WRITE (6,99) M,N,EOE,BMACH,CMACH,GAM,ETAD,RC,SF
      WRITE (6,102) SE,TK,WWO,WWOP,EMACH,FMACH,MC,AH
      IF (LR .NE. 0) WRITE (6,123) WI,WAP,WAPP,AM,AMP,AMPP
      IF (ISE.EQ.1 .AND. LR.EQ.0) WRITE (6,123) WI,WIP,WHPP,AM,AMP,AMPP
      IF (ISE .EQ. 1) GO TO 47
      WRITE (6,101) WI,WIP,WIPP,WIPPP,WOPPP
      WRITE (6,98) WE,WEP,WEPP,WEPPP,WRPPP
47    WRITE (6,94) C(1),C(2),C(3),C(4),C(5),C(6)
      WRITE (6,95) XOI,XI,XO,YO,XIE,XE,NOCON
      IF (ISE .EQ. 1) XC=XE
      IF (ISE .EQ. 1) XA=XE+TYE*CBET
48    NOCON=0
      WIP=WHP
      IF (QM .NE. ONE) GO TO 49
      IF (PP .LT. ZRO) FRIP=ZRO
      IF (PP .EQ. ZRO) FRIP=-XO*SF
      IF (PP .GT. ZRO) FRIP=PP-SF*XA
      IF (IQ .LT. 0) GO TO 50
      XOIN=SF*XO+FRIP
      X1IN=SF*X1+FRIP
      XIIN=SF*XI+FRIP
      WRITE (6,125) OM,XOIN,X1IN,AM,XIIN
      IF (IQ .GT. 0) GO TO 67
49    IF (N) 87,50,68
50    M=ZONK*(MD-1)+1
      JQ=1
      N=ND
      IP=IN
      IF (QM .NE. ONE) RETURN
      CALL OREZ(C,6)
      IF (IQ .LT. 0) GO TO 51
      IF (MQ .GE. 0 .AND. N .GT. 0) GO TO 51
      WRITE (6,104)
      GO TO 52
51    WRITE (6,105)
52    IF (IP) 53,67,58
C
C     LENGTH OF DOWNSTREAM VELOCITY DISTRIBUTION, RADIAL FLOW
53    WC=G2*CMACH/DSQRT(CMACH*CMACH+G9)
      WB=G2*BMACH/DSQRT(BMACH*BMACH+G9)
      WCB=WC-WB
      CALL SORCE(WB,D)
      XB=D(1)
      WBP=D(2)
      WSPP=D(3)
      WSPPP=D(4)
      C(1)=WB
      WCP=ZRO
      IF (LC) 54,55,56
54    XBC=THR*WCB/WBP
      WBPP=-TWO*WBP/XBC
      WRITE (6,109) ITLE,N3
      GO TO 57
55    WBPP=WSPP
      IF (MCP .LT. 0) WRITE (6,109) ITLE,N3
      IF (MCP .LT. 0) XBCN=THR*WCB/WBP
      IF (MCP .LT. 0) XBCM=-TWO*WBP/WBPP
      IF (MCP .GT. 0) WRITE (6,109) ITLE,N4
      IF (MCP .GT. 0) XBCN=FOUR*WCB/WBP
      IF (MCP .GT. 0) XBCM=-THR*WBP/WBPP
      ABCM=ONE-XBCN/XBCM
      IF (ABCM .LT. ZRO) GO TO 88
      XBC=XBCN/(DSQRT(ABCM)+ONE)
      GO TO 57
56    WBPP=-WSPP*IP/TEN
      IF (MCP.GT.0) XBCMN=CUBIC(WSPPP/THR,THR*WBPP,TLV*WBP,-TWO*TEN*WCB)
      IF (MCP.LT.0) XBCMN=CUBIC(WSPPP/SIX,WBPP,THR*WBP,-FOUR*WCB)
      XBCMX=FIV*WCB/(DSQRT(WBP**2-IP*WCB*WSPP/EIT)+WBP)
      IF (XC .GT. XB+XBCMX) XC=XB+XBCMX
      IF (XC .LT. XB+XBCMN) XC=XB+XBCMN
      XBC=XC-XB
      IF (MCP .LT. 0) WRITE (6,109) ITLE,N4
      IF (MCP .GT. 0) WRITE (6,109) ITLE,N5
57    C(2)=XBC*WBP
      C(3)=HALF*XBC*XBC*WBPP
      IF (MCP .LT. 0) C(4)=FOUR*WCB-THR*C(2)-TWO*C(3)
      IF (MCP .LT. 0) C(5)=-THR*WCB+TWO*C(2)+C(3)
      IF (MCP .GT. 0) C(4)=TEN*WCB-SIX*C(2)-THR*C(3)
      IF (MCP .GT. 0) C(5)=-FFTN*WCB+EIT*C(2)+THR*C(3)
      IF (MCP .GT. 0) C(6)=SIX*WCB-THR*C(2)-C(3)
      IF (LC .LT. 0) C(5)=ZRO
      IF (LC .LE. 0) C(6)=ZRO
      XC=XB+XBC
      GO TO 63
C
C     LENGTH OF DOWNSTREAM MACH NO. DISTRIBUTION, RADIAL FLOW
58    CALL CONIC(BMACH,D)
      XB=D(1)
      BMP=D(2)
      SMPP=D(3)
      SMPPP=D(4)
      CBM=CMACH-BMACH
      C(1)=BMACH
      BMPP=SMPP*IP/TEN
      IF (LC .NE. 0) GO TO 59
      IF (MCP .LT. 0) WRITE (6,108) ITLE,N3
      IF (MCP .LT. 0) XBCN=THR*CBM/BMP
      IF (MCP .LT. 0) XBCM=-TWO*BMP/BMPP
      IF (MCP .GT. 0) WRITE (6,108) ITLE,N4
      IF (MCP .GT. 0) XBCN=FOUR*CBM/BMP
      IF (MCP .GT. 0) XBCM=-THR*BMP/BMPP
      ABCM=ONE-XBCN/XBCM
      IF (ABCM .LT. ZRO) GO TO 88
      XBC=XBCN/(DSQRT(ABCM)+ONE)
      XC=XB+XBC
      GO TO 62
59    IF (LC .NE. 1) GO TO 61
      DO 60 K=1,ND
      READ (9) AX(K),AXM(K),AXMP(K)
      IF (K .EQ. 1) DX=XB-AX(1)
60    AXIS(1,K)=AX(K)+DX
      IF (AXMP(2) .EQ. ZRO) CALL SCOND(AX,AXM,AXMP,ND)
      AXM(1)=BMACH
      AXMP(1)=BMP
      XC=AXIS(1,ND)
      XBC=XC-XB
      WRITE (6,111) ITLE
      GO TO 63
61    IF (MCP.GT.0) XBCMN=CUBIC(SMPPP/THR,THR*BMPP,TLV*BMP,-TWO*TEN*CBM)
      IF (MCP.LT.0) XBCMN=CUBIC(SMPPP/SIX,BMPP,THR*BMP,-FOUR*CBM)
      XBCMX=FIV*CBM/(DSQRT(BMP**2+IP*CBM*SMPP/EIT)+BMP)
      IF (XC .GT. XB+XBCMX) XC=XB+XBCMX
      IF (XC .LT. XB+XBCMN) XC=XB+XBCMN
      XBC=XC-XB
      IF (MCP .LT. 0) WRITE (6,108) ITLE,N4
      IF (MCP .GT. 0) WRITE (6,108) ITLE,N5
62    C(2)=XBC*BMP
      C(3)=HALF*XBC*XBC*BMPP
      IF (MCP .LT. 0) C(4)=FOUR*CBM-THR*C(2)-TWO*C(3)
      IF (MCP .LT. 0) C(5)=-THR*CBM+TWO*C(2)+C(3)
      IF (MCP .GT. 0) C(4)=TEN*CBM-SIX*C(2)-THR*C(3)
      IF (MCP .GT. 0) C(5)=-FFTN*CBM+EIT*C(2)+THR*C(3)
      IF (MCP .GT. 0) C(6)=SIX*CBM-THR*C(2)-C(3)
      IF (LC .LE. 0) C(6)=ZRO 
63    CPP=ZRO
      CMP=ZRO
      IF (MCP .LT. 0) CPP=(TWO*C(3)+SIX*C(4)+TLV*C(5))/XBC**2
      BPPP=SIX*C(4)/XBC/XBC/XBC
      CPPP=SIX*(C(4)+FOUR*C(5)+TEN*C(6))/XBC/XBC/XBC
      XD=XC+TYE*CBET
      WRITE (6,100) M,N,NP,GAM,ETAD,RC,SF
      IF (IP) 64,67,65
64    WRITE (6,116) WB,WBP,WBPP,BPPP,WSPP,WC,WCP,CPP,CPPP,WSPPP
      GO TO 66
65    WRITE (6,117) BMACH,BMP,BMPP,BPPP,SMPP,CMACH,CMP,CPP,CPPP,SMPPP
66    WRITE (6,94) C(1),C(2),C(3),C(4),C(5),C(6)
      WRITE (6,118) AMACH,XA,XB,XBC,XC,XD
      XAIN=SF*XA+FRIP
      YAIN=SF*XA*DTAN(ETA)
      XBIN=SF*XB+FRIP
      XCIN=SF*XC+FRIP
      XDIN=SF*XD+FRIP
      TYIN=SF*TYE
      WRITE (6,120) XAIN,YAIN,XBIN,XCIN,XDIN,TYIN
67    IF (N) 87,4,68
68    IF (MQ .LT. 0) GO TO 69
C
C     CALCULATE AXIAL DISTRIBUTION
      WRITE (6,103) IAXIS
69    FN=N-1
      L=(N+40)/41
      IF (IP .NE. 0) XIE=XBC
      IF (IP .NE. 0) XI=XB
      Q=ZRO
      DO 84 K=1,N
      IF (ISE .EQ. 1 .AND. LC .EQ. 1) GO TO 72
      IF (IP .NE. 0) GO TO 70
      IF (NX .EQ. 0) Q=((N-K)/FN)**2
      IF (NX .NE. 0) Q=((N-K)/FN)**(NX*1.D-1)
      GO TO 71
70    IF (LC .EQ. 1) GO TO 72
      Q=(K-1)/FN
71    AXIS(1,K)=XIE*Q+XI
72    RMACH=ONE
      IF (ISE .EQ. 1) GO TO 75
      IF (AXIS(1,K) .LT. ONE+1.D-9) GO TO 74
      AB=AXIS(1,K)**(RGA/QT)
      IF (AB .LT. TWO) SM=((ONE+DSQRT(AB*GM-GM))**GA)**2
      IF (AB .GE. TWO) SM=(AB/GS)**G7
73    CM=SM**G5
      FQ=SM*(G6+G5*SM-CM*AB)/(SM-ONE)/G5/G6
      SM=SM-FQ
      IF (DABS(FQ) .GT. 1.D-9) GO TO 73
      RMACH=DSQRT(SM)
74    IF (IP .LT. 1) GO TO 78
75    IF (LC .EQ. 1) GO TO 76
      XM=C(1)+Q*(C(2)+Q*(C(3)+Q*(C(4)+Q*(C(5)+Q*C(6)))))
      IF (ISE .EQ. 1 .OR. K .EQ. 1) GO TO 77
      IF (RMACH .LT. XM) WRITE (6,124) K,RMACH,XM
      GO TO 77
76    XM=AXM(K)
77    XMP=(C(2)+Q*(TWO*C(3)+Q*(THR*C(4)+Q*(FOUR*C(5)+Q*FIV*C(6)))))/XIE
      IF (LC .EQ. 1) XMP=AXMP(K)
      XMPP=TWO*(C(3)+Q*(THR*C(4)+Q*(SIX*C(5)+Q*TEN*C(6))))/XIE/XIE
      XMPPP=SIX*(C(4)+Q*(FOUR*C(5)+TEN*Q*C(6)))/XIE/XIE/XIE
      GMM=XM*XM+G9
      GQ=DSQRT(GMM)
      W=G2*XM/GQ
      WM=G9*G2/GQ/GMM
      WP=WM*XMP
      WPP=WM*(XMPP-THR*XM*XMP*XMP/GMM)
      GMP=FIV*XM*XM*XMP*XMP/GMM-THR*XM*XMPP-XMP*XMP
      WPPP=WM*(XMPPP+THR*XMP*GMP/GMM)
      IF (MQ .LT. 0) GO TO 83
      IF (MOD(K-1,L) .NE. 0) GO TO 83
      GO TO 82
78    W=C(1)+Q*(C(2)+Q*(C(3)+Q*(C(4)+Q*(C(5)+Q*C(6)))))
      WP=(C(2)+Q*(TWO*C(3)+Q*(THR*C(4)+Q*(FOUR*C(5)+Q*FIV*C(6)))))/XIE
      WPP=TWO*(C(3)+Q*(THR*C(4)+Q*(SIX*C(5)+Q*TEN*C(6))))/XIE/XIE
      WPPP=SIX*(C(4)+Q*(FOUR*C(5)+TEN*Q*C(6)))/XIE/XIE/XIE
      GWW=G7-W*W*G8
      IF (GWW .GT. ZRO) GO TO 80
79    WRITE (6,119)
      GO TO 4
80    GW=DSQRT(GWW)
      XM=W/GW
      IF (K .EQ. 1 .OR. K .EQ. N) GO TO 81
      IF (IP .EQ. 0 .AND. RMACH .GT. XM) WRITE (6,124) K,RMACH,XM
      IF (IP .NE. 0 .AND. RMACH .LT. XM) WRITE (6,124) K,RMACH,XM
81    XMW=G7/GW/GWW
      XMP=XMW*WP
      XMPP=XMW*(WPP+THR*G8*W*WP*WP/GWW)
      GWP=FIV*W*W*WP*WP*G8/GWW+THR*W*WPP+WP*WP
      XMPPP=XMW*(WPPP+THR*WP*G8*GWP/GWW)
      IF (MQ .LT. 0) GO TO 83
      IF (MOD(K-1,L) .NE. 0) GO TO 83
82    XINCH=SF*AXIS(1,K)+FRIP
      WRITE (6,97) K,AXIS(1,K),XINCH,XM,XMP,XMPP,XMPPP,W,WP,WPP,WPPP
      IF (MOD(K+L-1,10*L) .EQ. 0) WRITE (6,115)
83    AXIS(3,K)=XM
      AXIS(2,K)=ZRO
      AXIS(5,K)=IE*HALF*(XM-ONE/XM)*WP/W 
      XBET=DSQRT(XM**2-ONE)
84    AXIS(4,K)=G2*DATAN(G4*XBET)-DATAN(XBET)
      IF (IQ .EQ. 0 .AND. IP .EQ. 0 .AND. M .LE. 0) GO TO 50
      IF (M) 87,4,85
85    IF (IP .NE. 0) RETURN
      DO 86 K=1,N
      DO 86 J=1,5
86    TAXI(J,K)=AXIS(J,K)
      RETURN
87    LV=-1
      RETURN
88    WRITE (6,114)
      GO TO 4
89    WRITE (6,112)
      GO TO 4
90    WRITE (6,121) NOCON
      GO TO 4
91    STOP
C
92    FORMAT (16I5)
93    FORMAT (8F10.3)
94    FORMAT (1H0,9X,3HC1=F11.7,3X,3HC2=F12.8,3X,3HC3=1PE15.7,3X,3HC4=,
     1E15.7,3X,3HC5=,E15.7,3X,3HC6=,E15.7)
95    FORMAT (1H0,9X,4HXOI=F12.8,3X,3HXI=F12.8,3X,3HXO=F12.8,3X,3HYO=F12
     1.8,3X,4HXIE=F12.8,3X,3HXE=F12.8,I5,11H ITERATIONS/)
96    FORMAT (1H ,4X,26HCURVE FROM MACH 1,    XIE=F12.8,6H   C2=F12.8,6H
     1   C3=1PE15.7,6H   C4=E15.7,6H   X1=0PF12.8 /)
97    FORMAT (1H ,I3,2F10.5,F10.6,1P3E14.6,0PF10.6,1P3E14.6 )
98    FORMAT (1H0,9X,3HWE=F12.8,4X,4HWEP=F12.8,4X,5HWEPP=,1PE15.7,4X,6HW
     1EPPP=,E15.7,4X,6HWRPPP=,E15.7)
99    FORMAT (1H ,4X,31HNO. OF POINTS ON 1ST CHAR. (M)=I3,5X,26HNO. OF P
     1OINTS ON AXIS (N)=I3,5X,9HEPSI/ETA=F8.5,4X,6HBMACH=F9.5,4X,6HCMACH 
     2=F9.5//5X,6HGAMMA=F7.4,5X,22HINFLECTION ANG. (ETA)=F8.4,2X,7HDEGRE
     3ES,5X,19HRAD. OF CURV. (RC)=F11.6,5X,18HSCALE FACTOR (SF)=F13.8)
100   FORMAT (1H ,4X,31HNO. OF POINTS ON 1ST CHAR. (M)=I3,5X,26HNO. OF P
     1OINTS ON AXIS (N)=I3,5X,33HNO. OF POINTS ON LAST CHAR. (NP)=I3//5X
     2,6HGAMMA=F7.4,5X,22HINFLECTION ANG. (ETA)=F8.4,2X,7HDEGREES,5X,19H
     3RAD. OF CURV. (RC)=F13.8,5X,18HSCALE FACTOR (SF)=F11.6)
101   FORMAT (1H0,9X,3HWI=F12.8,4X,4HWIP=F12.8,4X,5HWIPP=,1PE15.7,4X,6HW
     1IPPP=,E15.7,4X,6HWOPPP=,E15.7)
102   FORMAT (1H0,4X,3HY*=F10.8,4X,6HRMASS=F10.8,4X,4HWWO=F10.7,4X,5HWWO
     1P=,F11.8,4X,6HEMACH=,F8.5,4X,6HFMACH=F10.7,4X,A4,2HH=F9.5)
103   FORMAT (1H ,1X,A4/6H POINT,4X,1HX,7X,5HX(IN),3X,8HMACH NO.,4X,5HDM
     1/DX,8X,7HD2M/DX2,7X,7HD3M/DX3,7X,6HW=Q/A*,5X,5HDW/DX,8X,7HD2W/DX2,
     27X,7HD3W/DX3/)
104   FORMAT (1H0,//)
105   FORMAT (1H1)
106   FORMAT (1H1,3A4,16H THROAT CONTOUR,,A4,49H-DEG AXIAL VELOCITY DIST
     1RIBUTION FROM SONIC POINT/)
107   FORMAT (1H1,3A4,18H INVISCID CONTOUR,,A4,A4,68H AXIAL MACH NUMBER
     1DISTRIBUTION FROM THROAT CHARACTERISTIC WHICH HAS,I4,7H POINTS /)
108   FORMAT (1H ,3A4,20H DOWNSTREAM CONTOUR,,A4,35H-DEG AXIAL MACH NUMB
     1ER DISTRIBUTION/)
109   FORMAT (1H ,3A4,20H DOWNSTREAM CONTOUR,,A4,32H-DEG AXIAL VELOCITY
     1DISTRIBUTION/)
110   FORMAT (1H1,3A4,16H THROAT CONTOUR,,A4,69H-DEG AXIAL VELOCITY DIST
     1RIBUTION FROM THROAT CHARACTERISTIC WHICH HAS,I4,7H POINTS /)
111   FORMAT (1H ,3A4,19H DOWNSTREAM CONTOUR/)
112   FORMAT (1H0,38HSOLUTION TO CUBIC EQUATION IS NEGATIVE)
113   FORMAT (1H0,35HRC IS TOO LARGE TO ALLOW A SOLUTION)
114   FORMAT (1H0,38HBMACH IS TOO SMALL TO ALLOW A SOLUTION)
115   FORMAT (1H )
116   FORMAT (1H0,9X,3HWB=F12.8,4X,4HWBP=F12.8,4X,5HWBPP=,1PE15.7,4X,6HW
     1BPPP=,E15.7,5X,5HWSPP=,E15.7//10X,3HWC=0PF12.8,4X,4HWCP=F12.8,4X,
     25HWCPP=,1PE15.7,4X,6HWCPPP=,E15.7,4X,6HWSPPP=,E15.7 )
117   FORMAT (1H0,9X,6HBMACH=F9.5,4X,4HBMP=F12.8,4X,5HBMPP=,1PE15.7,4X,
     16HBMPPP=,E15.7,5X,5HSMPP=,E15.7//10X,6HCMACH=0PF9.5,4X,4HCMP=,F12.
     28,4X,5HCMPP=,1PE15.7,4X,6HCMPPP=,E15.7,4X,6HSMPPP=,E15.7)
118   FORMAT (1H0,9X,6HAMACH=F11.7,4X,3HXA=,F11.7,4X,3HXB=,F11.7,4X,
     14HXBC=,F11.7,4X,3HXC=,F12.7,4X,3HXD=,F12.7/)
119   FORMAT (1H0,47HVELOCITY GREATER THAN THEORETICAL MAXIMUM VALUE)
120   FORMAT (1H ,9X,7HXA(IN)=,F11.7,9H, YA(IN)=,F11.7,9H, XB(IN)=,F12.7
     1,9H, XC(IN)=,F12.7,9H, XD(IN)=,F12.7,9H, YD(IN)=,F11.7 /)
121   FORMAT (1H1,'NO CONVERGENCE IN',I4, 'ITERATIONS' )
122   FORMAT (1H1,3A4,18H INVISCID CONTOUR,,A4,A4,48H AXIAL MACH NUMBER
     1DISTRIBUTION FROM SONIC POINT /)
123   FORMAT (1H0,9X,3HWI=F12.8,4X,4HWIP=F12.8,4X,5HWIPP=1PE15.7,4X,3HMI
     1=0PF12.8,4X,4HMIP=F12.8,4X,5HMIPP=1PE15.7 )
124   FORMAT (1H ,I3,8H RMACH=,2F12.8 )
125   FORMAT (1H ,9X,4HMACH,F11.8,3H AT,F11.7,17H IN.,  MACH 1 AT,F11.7
     1,12H IN.,  MACH,F11.8,3H AT,F11.7,4H IN. /)
      END